<!doctype html>
<html>
	<head>
		<title>Museum</title>
		<meta charset="utf-8" />
		<link href="stil.css" rel="stylesheet" type="text/css">
		<script>
		let tdNodes, valgt = 0;
		const arrangementer = [
			{Dato: '', Tidspunkt: '', Arrangement: '', Informasjon: ''},
			{Dato: '1. juni', Tidspunkt: '11:00', Arrangement: 'Trondheim kammermusikkfestival: Fabelaktig formiddag', Informasjon: 'Dette er barnas og familiens festivaldag. Én billett gjelder for alt, og du kan velge mellom en rekke ulike forestillinger. '},
			{Dato: '4. juni', Tidspunkt: '14:30', Arrangement: 'Spill opp!', Informasjon: 'Mastereksamen NTNU fløyte v/Matthias Lauga '},
			{Dato: '6. juni', Tidspunkt: '13:00', Arrangement: 'Onsdagskonsert', Informasjon: 'Barokke treblåserensembler '},
			{Dato: '9. juni', Tidspunkt: '14:00', Arrangement: 'Juiogat: Joik for folk', Informasjon: 'En vandring i samisk musikkhistorie ved Lena Jansen '},
		]
		window.onload = () => {
			const table = document.getElementById('table');
			createTable(arrangementer,table);
			tdNodes = document.querySelectorAll('td')
			console.log(tdNodes)
			document.getElementById('btn').onclick = beregn;
		}
		const createTable = (objArr,output) => {
			const keys = Object.keys(objArr[0]);
			for (let i = 0; i < objArr.length; i++) {
				let values = Object.values(objArr[i]);
				let tr = document.createElement('tr');
				for (let j = 0; j < values.length; j++) {
					let td = document.createElement('td')
					td.style.fontWeight = (i > 0) ? ("normal") : ("bold"); // Overskrift som tykke bokstaver, andre blir vanlige tekst
					td.innerHTML = (i > 0) ? (values[j]) : (keys[j].toUpperCase()); // Overskrift som store bokstaver
					td.id = i;
					if (i > 0) {
						td.style.cursor = 'pointer'; // style for muspeker
						td.onclick = function() {
							marker(this.id);
						}
					}
					tr.appendChild(td);
				}
				output.appendChild(tr);
			}
		}
		const reset = () => {
			for (var i = 0; i < tdNodes.length; i++) {
				tdNodes[i].style.backgroundColor = 'white';
				tdNodes[i].style.color = 'black';
			}
		}
		const marker = (x) => {
			reset();
			for (var i = 0; i < tdNodes.length; i++) {
				if (x !== tdNodes[i].id) {
					tdNodes[i].style.backgroundColor = 'rgba(0,0,0,0.5)';
					if (tdNodes[i].id == 0) tdNodes[i].style.color = 'white';
				}
			}
			valgt = +x;
		}
		const beregn = () => {
			let voksen = +document.getElementById('voksen').value;
			let barn = +document.getElementById('barn').value;
			let output = document.getElementById('output');
			let melding = '';
			if (valgt == 0 || !Number.isInteger(voksen) || !Number.isInteger(barn) || (voksen == 0 && barn == 0) || voksen < 0 || barn < 0) {
				output.innerHTML = "Velg en arrengement ved å klikk på arrengementnavnet, og angi antall biletter gitt i heltall!"
				return;
			}
			let antall = (voksen + barn > 1) ? (`${voksen + barn} biletter`) : (`${voksen + barn} bilett`);
			let arrengement = arrangementer[valgt].Arrangement;
			let pris = (voksen + barn >= 5) ? (`${(voksen*100 + barn*50) * 0.80}, inklusiv grupperabatt på 20 prosent.`) : (`${voksen*100 + barn*50}.`);
			if (voksen !== 0) {
				voksen = (voksen == 1) ? (`${voksen} voksen`) : (`${voksen} voksne`);
			} else {
				voksen = '';
			}
			if (barn !== 0) {
				barn = (voksen == "") ? (`${barn} barn`) : (`og ${barn} barn`);
			} else {
				barn = '';
			}
			let typeBilett = `${voksen} ${barn}`;
			output.innerHTML = `Du har bestilt ${antall} til "${arrengement}", ${typeBilett}. Totalprisen er kr ${pris}`
		}
		</script>
	</head>
	<body>
		<header>
			<p><a href="index.html">Eksamensoppgave V2018</a></p>
		</header>
		<br>
		<main>
			<br>
			<h1>Aktiviteter</h1>
			<p>I tabellen under ser du en oversikt over noen arrangementer i juni 2018. </p>
			<p>Pris voksen: 100 kr<br/>Pris barn: 50 kr </p>
			<table id="table">
			</table>
			<p>Velg antall billetter:</p>
			<p>
				Voksen: <input type="number" id="voksen" value="0">
				Barn: <input type="number" id="barn" value="0">
			</p>
			<p id="output"></p>
			<button id="btn">Beregn</button>
		</main>
		<br>
	</body>
</html>
