<!doctype html>
<html>
	<head>
		<title>Sykkelferie</title>
		<meta charset="utf-8" />
		<link href="stil.css" rel="stylesheet" type="text/css">
		<style media="screen">
		.images button {
			display: none;
			cursor: default;
		}
		</style>
		<script>
		// Globale variabler
		const avstander = [
			['	', 62.3, 58.8, 44.6, 33.2], //Askim
			[62.3, '	', 37.9, 65.3, 60.1], //Halden
			[58.8, 37.9, '	', 40.5, 78.5], //Fredrikstad
			[44.6, 65.3, 40.5, '	', 77.6], //Ørje
			[33.2, 60.1, 78.5, 77.6, '	']  //Moss
		];
		let kartKnappAntall = ['askim','halden','fredrikstad','ørje','moss']
		let option;
		let fart = 20 //km/t
		let steder = [], stederTall = [];

		// LOAD DOM
		window.onload = () => {
			option = document.getElementById('option')
			option.onchange = function() {sjekkValg(this.value)};
		}

		function sjekkValg(value) {
			if (kartKnappAntall.indexOf(value) == -1) return;
			if (steder[steder.length-1] !== value) {
				document.getElementById('optionTekst').innerHTML = 'Velg neste rute!';
				stederTall.push(kartKnappAntall.indexOf(value));
				steder.push(value);
				beregn();
			}
			resetOption();
		}
		function resetOption() {
			option.selectedIndex = 0;
		}
		function skrivUt(id,tekst) {
			document.getElementById(id).innerHTML = tekst;
		}
		function beregn() {
			let visIKart = Array.from(new Set(steder)); // Tar vekk duplikat i array ved Set()
			let stederTekst = steder.join(' - '); // Gjør om array til string med "-" i mellomrom
			let reiseLengde = 0;
			let reiseTid = 0;

			// Viser steder som besøkes
			for (var i = 0; i < visIKart.length; i++) {
				if (kartKnappAntall.indexOf(visIKart[i]) !== -1) {
					document.getElementById(visIKart[i]).style.display = 'block'
				}
			}

			// Beregning skjes her, bruker tabell avstand ovenfor:
			for (var i = 1; i < stederTall.length; i++) {
				x = stederTall[i-1];
				y = stederTall[i];
				reiseLengde += avstander[x][y];
			}
			// Formel: s = v*t
			reiseTid = Math.round(reiseLengde/fart);
			skrivUt('output',`Stedene man besøker: ${stederTekst}<br/>Totalavstand for ruten: ${Math.round(reiseLengde)} km<br/>Timer sykkel man påregner: ${reiseTid} timer`);
		}
		</script>
	</head>
	<body>
		<header>
			<p><a href="index.html">Eksamensoppgave V2015</a></p>
		</header>
		<br>
		<main id="main">
			<br>
			<div>
				<h2>Program for å legge opp egen sykkelrute</h2>
				<p>For at det skal oppleves som enkelt å planlegge andre turer på sykkel i fylket,
					har vi utviklet en applikasjon som hjelper deg med å lage ruter med andre
					steder enn det de oppsatte rutene legger opp til! </p>
				<p>Start med å velge destinasjon under!</p>
				<p>
					<select id="option">
						<option value="" id="optionTekst">Velg rute!</option>
						<option value="askim">Askim</option>
					  <option value="halden">Halden</option>
					  <option value="fredrikstad">Fredrikstad</option>
					  <option value="ørje">Ørje</option>
						<option value="moss">Moss</option>
					</select>
				</p>
				<p id='output'></p>
			</div>

			<div id="after">
				<div class="images">
					<img src="vedlegg/stortkartostfold.gif" width='450px' height='600px' alt="kartOstfold">
					<button id="halden" name="kartKnapp">Halden</button>
					<button id="fredrikstad" name="kartKnapp">Fredrikstad</button>
					<button id="askim" name="kartKnapp">Askim</button>
					<button id="ørje" name="kartKnapp">Ørje</button>
					<button id="moss" name="kartKnapp">Moss</button>
				</div>
			</div>
		</main>
	</body>
</html>
