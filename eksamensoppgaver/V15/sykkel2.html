<!doctype html>
<html>
	<head>
		<title>Sykkelferie</title>
		<meta charset="utf-8" />
		<link href="stil.css" rel="stylesheet" type="text/css">
		<script>
		const attraksjoner = [
			{attraksjon: '', pris: '', type: ''},
			{attraksjon: 'Saftpressekurs Askim saftpressen (Askim)', pris: 190, type: 0},
			{attraksjon: 'Spasertur langs Olavsleden (Halden)', pris: 150, type: 1},
			{attraksjon: 'Omvisning Rød Herregård (Halden)', pris: 95, type: 1},
			{attraksjon: 'Tur med MS Strømfoss (Halden)', pris: 110, type: 1},
			{attraksjon: 'Skattejakt i gamlebyen (Fredrikstad)', pris: 95, type: 0},
			{attraksjon: 'Elvelangs Glomma (Fredrikstad)', pris: 65, type: 0},
			{attraksjon: 'Mini - Cruise på Glomma (Fredrikstad)', pris: 145, type: 0},
			{attraksjon: 'Rammeverksted på Gallen Lund (Ørje)', pris: 120 , type: 1},
			{attraksjon: 'Våler Klatrepark (Moss)', pris: 195, type: 0},
			{attraksjon: 'Pilegrimsveien (Moss)', pris: 60, type: 0}
		];
		let table1,table2, radio;
		window.onload = () => {
			table1 = document.getElementById('table1');
			table2 = document.getElementById('table2');
			radio = document.querySelectorAll('input[type="radio"]')
			for (x in radio) {
				radio[x].onchange = function() {velgRute(this.value);};
			}
		}

		const createTable = (objArr,output,type=0) => {
			let keys = Object.keys(objArr[0]);
			for (var i = 0; i < objArr.length; i++) {
				let values = Object.values(objArr[i]);
				let tableRow = document.createElement('tr');
				for (var j = 0; j < values.length; j++) {
					let tableColumn = document.createElement('td');
					if (j < 2 && (values[2] == type || values[2] == type-1)) {
						tableColumn.innerHTML = (i > 0) ? ( (Number.isInteger(values[j])) ? (`${values[j]},-`) : (values[j])) : (keys[j].toUpperCase())
						tableColumn.style.fontWeight = (i > 0) ? ('normal') : ('bold')
						tableRow.appendChild(tableColumn);
					}
				}
				tableRow.id = i;
				tableRow.value = values[1]
				if (i > 0) {
					tableRow.onclick = function() {
						visValg(this.value,this.id)
					}
				}
				output.appendChild(tableRow)
			}
		}

		const reset = (obj) => {
			obj.innerHTML = '';
		}
		const resetColor = (obj) => {
			obj.firstChild.style.backgroundColor = 'white';
			obj.lastChild.style.backgroundColor = 'white';
			obj.className = 'i'
		}

		function velgRute(type) {
			reset(table1);
			reset(table2);
			let output = (type == 0) ? (table1) : (table2);
			createTable(attraksjoner,output,+type)
		}

		function visValg(value,id) {
			let nodes = document.querySelectorAll('tr');
			for (let i = 0; i < nodes.length; i++) {
				if (nodes[i].id == id) {
					let check = (nodes[i].firstChild.style.backgroundColor == 'rgba(0, 0, 0, 0.25)')
					if (check) {
						resetColor(nodes[i]);
					} else {
						nodes[i].className = 'j'
						nodes[i].firstChild.style.backgroundColor = 'rgba(0,0,0,0.25)'
						nodes[i].lastChild.style.backgroundColor = 'rgba(0,0,0,0.25)'
					}
				}
			}
			visPris(nodes);
		}

		function visPris(nodes) {
			let pris = 0;
			for (var i = 0; i < nodes.length; i++) {
				if (nodes[i].className == 'j') {
					pris += nodes[i].value;
				}
			}
			output.innerHTML = `Samlet pris: ${pris} kr`
		}
		</script>
	</head>
	<body>
		<header>
			<p><a href="index.html">Eksamensoppgave V2015</a></p>
		</header>
		<br>
		<main>
			<br>
			<div>
				Kortrute: <input type="radio" name="rute" value="0">
				Langrute: <input type="radio" name="rute" value="1">
			</div>
			<div>
				<table id="table">
					<tr>
						<td>Kort Rute</td>
						<td>Lang Rute</td>
					</tr>
					<tr>
						<td><table id="table1"></table></td>
						<td><table id="table2"></table></td>
					</tr>
				</table>
				<p id='output'></p>
			</div>
		</main>
	</body>
</html>
