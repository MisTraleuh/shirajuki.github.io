<!doctype html>
<html>
	<head>
		<title>H14 - Biler</title>
		<meta charset="utf-8" />
		<link href="stil.css" rel="stylesheet" type="text/css">
		<style media="screen">
			label:hover {
				color: red;
			}
			input {
				display: none;
			}
			</style>
		<script>
		window.onload = oppstart;
		/* Globale variabler */
		var input;
		// 2 dimensjonall array bil, av objecter (assosiativ array) for en lettere forståelse i verdiene som blir oppgitt.
		var bil = [
			{modell:"", trend:"", titanium:"", familiepakke:"", førerassistenstpakke:"", stilpakke:""}, //0
			{modell:"Kuga", trend:401000, titanium:420000, familiepakke:1000, førerassistenstpakke:10200, stilpakke:9200}, //1
			{modell:"C-max", trend:320000, titanium:335000, familiepakke:1000, førerassistenstpakke:9400, stilpakke:3600}, //2
			{modell:"Focus", trend:255000, titanium:325000, familiepakke:900, førerassistenstpakke:12500, stilpakke:9000}, //3
			{modell:"Mondeo", trend:281000, titanium:361000, familiepakke:1100, førerassistenstpakke:9900, stilpakke:7200}, //4
		];
		/* Oppstarts funksjon */
		function oppstart() {
			print(); // kjører egen definert print funksjon, resetter tekst.
			/* Loader deretter DOM-elementer som trengs, og setter dem i en createElement loop, for å lage en tabell ut fra en array*/
			var table = document.getElementById("table");
			// objects i bil-arrayen blir deretter gjort om til enkle arrayer.
			var bilerK = Object.keys(bil[i]);
			var bilerV = Object.values(bil[i]);
			for (var i = 0; i < bil.length; i++) {
				var tr = document.createElement("tr");
				tr.id = i;
				table.appendChild(tr);
				/* Legger til ulike pseudo og tags til elementene som blir lagd*/
				for (var j = 0; j < bilerK.length; j++) {
					var td = document.createElement("td");
					var input = document.createElement("input");
					var label = document.createElement("label");
					td.style.fontWeight = (i > 0) ? ("normal") : ("bold"); // Overskrift som tykke bokstaver, andre blir vanlige tekst
					td.id=i+"n"+j+"o" // gir id, kommer til å senere brukes i funksjonen under, utregning()
					label.style.cursor = (i > 0) ? ("pointer") : ("default"); // style for muspeker
					td.innerHTML = (i > 0) ? ("") : (bilerK[j].toUpperCase()); // Overskrift som store bokstaver
					input.id = i+"n"+j;
					input.type = (j > 2) ? ("checkbox") : ("radio");
					input.name = (j==2) ? (j-1) : (j);
					label.setAttribute("for",input.id);
					input.onclick = function() {
						utregning(this.id);
					}
					label.innerHTML = bilerV[j];
					tr.appendChild(td);
					if (i>0) {
						td.appendChild(input);
						td.appendChild(label);
					}
				}
			}
			/* Loader deretter de nylagde elementene til i en array*/
			inputCheck = document.querySelectorAll('input');
		}
		/* Funksjon for å resette tabellen */
		function reset() {
			for (var i = 0; i < inputCheck.length; i++) {
				inputCheck[i].checked = false;
				inputCheck[i].parentElement.style.backgroundColor = "white";
			}
		}
		/* Funksjon for markering av hva som blir valgt */
		function utregning(x) {
			// Onclick av element starter med reset av klikk
			if (document.getElementById(x).parentElement.style.backgroundColor == "rgba(0, 0, 0, 0.5)") {
				reset();
			}
			// Mørker deretter vekk alt det andre enn delen som blir trykket
			for (var i = 0; i < inputCheck.length; i++) {
				inputCheck[i].parentElement.style.backgroundColor = "rgba(0,0,0,0.5)";
				inputCheck[i].parentElement.style.color = "black";
				if ((inputCheck[i].id)[0] == x[0]) { // <--
					inputCheck[i].parentElement.style.backgroundColor = "white";
					if (inputCheck[i].checked) { // Valgt element blir fargt rød
						inputCheck[i].parentElement.style.color = "red";
					}
				}
			}
			// Kjører funksjonen regning for utregning
			regning(x[0]);
		}
		function regning(x) {
			print(); //reset output tekst
			var beregning = 0
			var biler = Object.values(bil[x]) //Henter tallverdiene fra tabellen
			// Looper gjennom tabellen
			for (var i = 0; i < biler.length; i++) {
				if (document.getElementById(x+"n"+i).checked) { // Legger sammen alle "valgte" elementene som er av tall
					beregning+= (Number.isInteger(biler[i])) ? (biler[i]) : (0)
				}
			}
			/* Gir deretter bare en utregning dersom både modell og type er valgt */
			if (document.getElementById(x+"n"+0).checked && (document.getElementById(x+"n"+1).checked || document.getElementById(x+"n"+2).checked)) {
				print(beregning+" kr");
			}
		}
		/* Print funksjon */
		function print(x="Velg en bilmodell og type") {
			document.getElementById("output").innerHTML = x;
		}
		</script>
	</head>
	<body>
		<header>
			<p><a href="index.html">Eksamensoppgave H2014</a></p>
		</header>
		<main>
			<img width="200px" src="vedlegg/kuga_front.jpg">
			<h2>Applikasjon for å finne pris</h2>
			<p>Bilprodusenten vår har mange modeller å tilby dere med mye informasjon om de ulike modellene på
				nettsidene våre. I tillegg til å se de ulike modellene kan dere også studere masse tilleggsutstyr.
				De kan velge mellom modellene Kuga, C-max, Focus og Mondeo.
				Alle modellene finnes i to forskjellige utstyrsvarianter, Trend og Titanum, og man kan f.eks.
				velge mellom Kuga Trend og Kuga Titanum. Alle modellene kan utstyres med utstyrspakker som familie-,
				førerassistent- og stilpakker. De kan velge å kjøpe flere utstyrspakker til samme bil</p>
			<div>
				<table id="table" style="width:100%; max-width:750px; margin: 0 auto;">
				</table>
			</div>
			<br>
			<output>Pris: <span id="output"></span></output>
		</main>
		<br>
	</body>
</html>
