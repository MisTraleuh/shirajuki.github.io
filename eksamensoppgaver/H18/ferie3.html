<!doctype html>
<html>
	<head>
		<title>H14 - Biler</title>
		<meta charset="utf-8" />
		<link href="stil.css" rel="stylesheet" type="text/css">
		<style media="screen">
			label:hover {
				color: red;
			}
			input {
				display: none;
			}
			</style>
		<script>
		window.onload = oppstart;
		/* Globale variabler */
		var nodes;
		var hytte = [], hytteinfo = [];
		function backup() {
			hytte = [
				{Hytte: '', Jul: '', Vinterferie: '', Påske: ''},
				{Hytte: 'Granstua', Jul: 'utleid', Vinterferie: 'utleid', Påske: 'ledig'},
				{Hytte: 'Granbo', Jul: 'ledig', Vinterferie: 'ledig', Påske: 'utleid'},
				{Hytte: 'Grantoppen', Jul: 'utleid', Vinterferie: 'ledig', Påske: 'utleid'},
				{Hytte: 'Granhaug', Jul: 'utleid', Vinterferie: 'ledig', Påske: 'utleid'}
			]
			hytteinfo = [
				{Hytte: '', Sengeplasser: '', Standard: '', Badstue: '', Ukepris: '', Bilde: ''},
				{Hytte: 'Granstua', Sengeplasser: '4', Standard: 'Høy', Badstue: 'Ja', Ukepris: '12 000', Bilde: 'granstua.jpg'},
				{Hytte: 'Granbo', Sengeplasser: '6', Standard: 'Middels', Badstue: 'Nei', Ukepris: '15 000', Bilde: 'granbo.jpg'},
				{Hytte: 'Grantoppen', Sengeplasser: '8', Standard: 'Lav', Badstue: 'Nei', Ukepris: '16 000', Bilde: 'grantoppen.jpg'},
				{Hytte: 'Granhaug', Sengeplasser: '10', Standard: 'Høy', Badstue: 'Ja', Ukepris: '30 000', Bilde: 'granhaug.jpg'}
			]
		}
		/* Oppstarts funksjon */
		function oppstart() {
			backup();
			/* Loader deretter DOM-elementer som trengs, og setter dem i en createElement loop, for å lage en tabell ut fra en array*/
			var table = document.getElementById("table1");
			tegnTabell(hytte,table);
			/* Loader deretter de nylagde elementene til i en array*/
			nodes = document.querySelectorAll('td');
		}
		function tegnTabell(objArr,output,type = 0) {
			var table = output;
			var keys = Object.keys(objArr[0]);
			for (var i = 0; i < objArr.length; i++) {
				var value = Object.values(objArr[i]);
				var tr = document.createElement("tr");
				table.appendChild(tr);
				/* Legger til ulike pseudo og tags til elementene som blir lagd*/
				for (var j = 0; j < keys.length; j++) {
					var td = document.createElement("td");
					td.style.fontWeight = (i > 0) ? ("normal") : ("bold"); // Overskrift som tykke bokstaver, andre blir vanlige tekst
					td.innerHTML = (i > 0) ? (value[j]) : (keys[j].toUpperCase()); // Overskrift som store bokstaver
					td.id = `${i}${j}`;
					if (j > 0) {
						td.style.cursor = 'pointer'; // style for muspeker
						td.onclick = function() {
							show(this.id,1);
						}
					}
					if (type == 1) {
						td.className = 't2';
						td.onclick = function() {
							show(this.id,0);
						}
					}
					tr.appendChild(td);
				}
			}
		}
		/* Funksjon for å resette tabellen */
		function reset(nodeArr) {
			for (var i = 0; i < nodeArr.length; i++) {
				nodeArr[i].style.backgroundColor = "white";
				nodeArr[i].style.color = "black";
			}
		}
		var huskeValg = [];
		function marker(nodeArr,x,type) {
			for (var i = 0; i < nodeArr.length; i++) {
				if ((nodeArr[i].id)[type] == x[type]) {
					nodeArr[i].style.backgroundColor = "rgba(0,0,0,0.8)";
					nodeArr[i].style.color = "white";
				}
			}
			if (type == 1) huskeValg[0] = x[type];
			if (type == 0) {
				huskeValg[1] = x[type];
				valgt(huskeValg);
			}
		}
		function valgt(id) {
			console.log(id)
			console.log(hytte[id[1]])
		}
		function show(x, type = 1) {
			reset(nodes)
			marker(nodes,x,type);
			if (type == 1) {
				nodes = document.querySelectorAll('td');
				backup();
				reset(nodes)
				marker(nodes,x,type);

				var table = document.getElementById("table2");
				table.innerHTML = '';
				let hytter = Object.values(hytte);
				let ledig = [];
				for (var i = 1; i < hytter.length; i++) {
					hytter[i] = Object.values(hytte[i]);
					console.log(hytter[i][x[type]] == "utleid");
					if (hytter[i][x[type]] == "utleid") {
						hytteinfo.splice(i,1)
					}
				}
				console.log(hytteinfo)
				tegnTabell(hytteinfo,table,1);
				nodes = document.getElementsByClassName('t2');
			}
		}
		</script>
	</head>
	<body>
		<header>
			<p><a href="index.html">Eksamensoppgave H2018</a></p>
		</header>
		<main>
			<h2>Applikasjon for å finne pris</h2>
			<p>yeh</p>
			<div>
				<table id="table1" style="width:100%; max-width:750px; margin: 0 auto;">
				</table>
				<br/>
				<table id="table2" style="width:100%; max-width:750px; margin: 0 auto;">
				</table>
			</div>
			<br>
			<button id="btn">Book!</button>
		</main>
		<br>
	</body>
</html>
